!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6388cba2-a873-4513-ba68-ce90399a45dc",e._sentryDebugIdIdentifier="sentry-dbid-6388cba2-a873-4513-ba68-ce90399a45dc")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[657],{9758:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[channelNo]",function(){return n(5427)}])},5427:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return L},default:function(){return _channelNo_}});var s=n(5893),a=n(7294),i=n(9473);let useAppDispatch=()=>(0,i.I0)(),l=i.v9;var r=n(5518),o=n(7484),c=n.n(o);n(9132);var d=n(7412),u=n.n(d),m=n(9212),p=n.n(m),h=n(178),v=n.n(h),g=n(9387),f=n.n(g);c().extend(u()),c().extend(p()),c().extend(v()),c().extend(f()),c().locale("ko");let x={LIVE:"LIVE",END:"END",VOD:"VOD",PREVIEW:"PREVIEW"},numWithCommas=e=>Math.floor(e=Number(e)||"0").toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),getProtocolExceptURL=e=>(null==e?void 0:e.indexOf("http:"))!==-1||(null==e?void 0:e.indexOf("https:"))!==-1?e?"//"+e.replace(/(^(https:\/\/|http:\/\/))/g,""):"":e,isExceptURL=e=>(null==e?void 0:e.indexOf("http:"))!==-1||(null==e?void 0:e.indexOf("https:"))!==-1,setChannelLiveStatus=(e,t)=>{let n=c()(String(e.liveStartTime),"yyyymmddHHmmss"),s=c()(String(e.liveEndTime),"yyyymmddHHmmss"),a=e.playUrl,i="",l=c()(t,"yyyymmddHHmmss");return l.isSameOrAfter(n)&&l.isBefore(s)?i="LIVE":l.isBefore(n)?i="PREVIEW":l.isAfter(n)&&(i=a?"VOD":"END"),i},shareSns=(e,t,n,s)=>{let a="https://twitter.com/intent/tweet?text="+encodeURIComponent(t)+"&url="+encodeURIComponent(n);switch(e){case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(n),"페이스북 공유");break;case"twitter":window.open(a);break;case"sms":location.href="sms: "+(r.gn?"&":"?")+"body="+encodeURIComponent(n+"  \n"+s);break;case"line":window.open("https://social-plugins.line.me/lineit/share?url="+n+"&text="+encodeURIComponent(t+"\n"+s));break;case"copyurl":prompt("아래 주소를 복사해주세요.",n)}},isEmptyObj=e=>e.constructor===Object&&0===Object.keys(e).length;var N=n(1608),j=n(5215),video=e=>{let{options:t,setVideoPlayer:n,videoDivRef:i,onReady:l}=e,r=(0,a.useRef)(null),[o,c]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=r.current;if(e){let s=(0,j.Z)(e,t,()=>{console.log("player is ready"),l&&l(s)});c(s),n&&n(s)}return()=>{o&&o.dispose()}},[t.sources.src]),(0,a.useEffect)(()=>(o&&(o.playsinline(!0),o.reloadSourceOnError({errorInterval:10}),o.poster(t.sources.poster)),()=>{o&&o.dispose()}),[o]),(0,s.jsx)("div",{"data-vjs-player":!0,ref:i,children:(0,s.jsx)("video",{className:"video-js",ref:r,playsInline:!0})})},live_video=e=>{let{liveChannel:t,setErrorPlayer:n,setPlayerLoading:i,setVideoPlayer:o,setVideoLoading:c,playerLoading:d,isOnReadyViewClass:u,setIsOnReadyViewClass:m}=e,p=useAppDispatch(),h=(0,a.useRef)(null),v=l(e=>e.liveTv.isContentHide),g=l(e=>e.liveTv.liveState),f=l(e=>e.liveTv.pipMode),j=g!==x.LIVE,{show_shadow_top:b,show_shadow_bottom:y}=l(e=>e.room.roomInfo),C={autoplay:!0,muted:!0,controls:j,preload:"auto",sources:{src:getProtocolExceptURL(t.playUrl),type:"application/x-mpegURL"},poster:t.scheduleListImage,html5:{vhs:{overrideNative:!0},nativeVideoTracks:!1,nativeTextTracks:!1}},setViewContentHide=e=>{f?window.parent.postMessage({isMoveSubmainPage:!0},"*"):-1!==e.target.className.indexOf("btnExpand")||-1!==e.target.className.indexOf("vjs-icon-placeholder")||-1!==e.target.className.indexOf("vjs-control-bar")||e.target.closest(".btnRefresh")||e.target.closest(".btnSearch")||e.target.closest(".inpTextWrap")||e.target.closest(".layerAlert")||"btnNewChat"===e.target.className||p(N._.setIsContentHide(!v))};return(0,s.jsx)("div",{className:"liveTvVideoWrap \n      ".concat(f?"pipMode":"".concat(1===b?"shadowTop":"","\n            ").concat(1===y?"shadowBottom":""),"\n        "),onClick:e=>setViewContentHide(e),children:(0,s.jsx)("div",{className:"liveTvVideo ".concat(f&&"pipMode"," "),children:(0,s.jsx)("div",{className:"videoBx",children:(0,s.jsx)("div",{id:"videoContainer",children:(0,s.jsx)(video,{options:C,setVideoPlayer:o,videoDivRef:h,onReady:e=>{if(e){let t=e.controlBar,s=t.volumeMenuButton;null!==t&&(t.addChild("VolumeControl"),t.addChild("MuteToggle"),t.removeChild(s),t.hide()),e.on("ready",()=>{c(!0)}),e.on("loadeddata",function(){c(!1),n(!1),i(!0),e.poster(""),e.controlBar.show();let t=e.videoHeight(),s=e.videoWidth(),a=!t||!s||t>s;if(p(N._.setIsHorizon(!a)),p(N._.setIsVertical(a)),h.current){let e=h.current.children;if(h.current.className="video-js vjs-controls-enabled vjs-workinghover vjs-v7 vjs-layout-medium bc-player-default_default bc-player-default_default-index-0 vjs-mouse vjs-dock vjs-plugins-ready vjs-player-info vjs-contextmenu vjs-contextmenu-ui vjs-errors vjs-playing vjs-has-started vjs-user-active not-hover vjs_video_3-dimensions",r.tq){p(N._.setIsVertical(!0));let landscapeEvent=()=>{p(N._.setIsHorizon(!0)),p(N._.setIsExpand(!0))},portraitEvent=()=>{if(a?p(N._.setIsHorizon(!1)):p(N._.setIsHorizon(!0)),p(N._.setIsExpand(!1)),e)for(let t=0;t<e.length;t++)-1!==e[t].className.indexOf("vjs-tech")&&e[t].classList.add("full")},t=window.matchMedia("(orientation: landscape)"),changeOrientation=()=>{let e=t.matches?"landscape":"portrait";"landscape"===e?landscapeEvent():portraitEvent()},getOrientation=()=>{let e=window.orientation;0==e||180==e?portraitEvent():landscapeEvent()};r.gn?(t.addEventListener("change",changeOrientation),changeOrientation()):(window.onorientationchange=getOrientation,a&&getOrientation())}else r.nI&&!a&&p(N._.setIsExpand(!0));m(!0)}}),e.on("error",function(t){t.stopImmediatePropagation(),c(!1),e.removeClass("vjs-waiting"),e.removeClass("vjs-error");let s=e.error();console.log("error!",s.code,s.type,s.message),-2===s.code&&location.reload(),(3===s.code||4===s.code||15===s.code)&&n(!0)})}return()=>{e&&e.dispose()}}})})})})})},noticeTab=e=>{var t;let{liveChannel:n}=e,a=l(e=>e.chat.noticeMessage.data),i=l(e=>{var t,n;return null===(n=e.chat.noticeMessage.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message});return(0,s.jsx)("div",{className:"tabPanel",children:(0,s.jsx)("div",{className:"notice",children:i?(0,s.jsx)("ul",{className:"noticeList",children:(0,s.jsxs)("li",{children:[(0,s.jsx)("p",{className:"notice",children:null===(t=i[0])||void 0===t?void 0:t.body}),(0,s.jsxs)("p",{className:"date",children:[(0,s.jsx)("span",{children:c()(null==a?void 0:a.timestamp).format("MM-DD")}),(0,s.jsx)("span",{children:c()(null==a?void 0:a.timestamp).format("HH:mm")})]})]},null==a?void 0:a._id)}):(0,s.jsx)("div",{className:"noInfoLayer",children:(0,s.jsx)("p",{children:"게시물 없음"})})})})},qnaTab=e=>{let{faqList:t}=e,n=t.filter(e=>e.isDisplay);return(0,s.jsx)("div",{className:"tabPanel",children:n&&n.length>0?(0,s.jsx)("div",{className:"qna",children:n.map(e=>(0,s.jsxs)("dl",{className:"qnaList",children:[(0,s.jsx)("dt",{children:"Q. "+e.question}),(0,s.jsx)("dd",{children:"A. "+e.answer})]},e.num))}):(0,s.jsx)("div",{className:"noInfoLayer",children:(0,s.jsx)("p",{children:"게시물 없음"})})})},guideTab=e=>{let{liveChannel:t}=e,n=t.liveInfo?t.liveInfo.split("\n"):null;return(0,s.jsx)("div",{className:"tabPanel",children:(0,s.jsxs)("div",{className:"guide",children:[(0,s.jsx)("h2",{className:"guideTitle",children:t.scheduleTitle}),n&&(0,s.jsx)("p",{className:"guideText",children:n.map((e,t)=>{let i=t===n.length?(0,s.jsx)(a.Fragment,{children:e},t):(0,s.jsxs)(a.Fragment,{children:[e,(0,s.jsx)("br",{})]},t);return i})})]})})};let b=[{key:"guide",value:"라이브 안내"},{key:"notice",value:"공지사항"},{key:"qna",value:"자주 묻는 질문"}];var channelInfoLayer=e=>{let{isOpenChannelInfoLayer:t,setIsOpenChannelInfoLayer:n,liveChannel:i}=e,[l,r]=(0,a.useState)("notice"),o=i.faqList?i.faqList:[],clickTap=(e,t)=>{e.stopPropagation(),r(t)},c=(0,a.useMemo)(()=>b.map(e=>{let{key:t,value:n}=e;return(0,s.jsx)("li",{className:"tabItem ".concat(l===t?"active":""),children:(0,s.jsx)("a",{className:"tabBtn",onClick:e=>clickTap(e,t),children:n})},t)}),[l]),initializeChannelInfo=()=>{t.active&&r(t.active)};return(0,a.useEffect)(()=>{initializeChannelInfo()},[t]),(0,s.jsx)("div",{className:"bottomLayerWrap noticeLayer ".concat(t.visible?"on":""),onClick:e=>{e.target.closest(".bottomLayer")||n({visible:!t.visible,active:t.active})},children:(0,s.jsxs)("div",{className:"bottomLayer",children:[(0,s.jsx)("div",{className:"listHeader",children:(0,s.jsx)("button",{type:"button",className:"btnLayerClose",onClick:()=>n({visible:!t.visible,active:t.active}),children:(0,s.jsx)("span",{className:"blind",children:"레이어 닫기"})})}),(0,s.jsx)("div",{className:"listContent",children:(0,s.jsxs)("div",{className:"tabGroup",children:[(0,s.jsx)("ol",{className:"tabList",children:c}),(0,s.jsxs)("div",{className:"tabContent",children:["guide"===l&&(0,s.jsx)(guideTab,{liveChannel:i}),"notice"===l&&(0,s.jsx)(noticeTab,{liveChannel:i}),"qna"===l&&(0,s.jsx)(qnaTab,{faqList:o})]})]})})]})})},common_shareSns=e=>{let{liveChannel:t,isOpenShareSns:n,setIsOpenShareSns:a}=e,share=e=>{e.preventDefault();let n=e.currentTarget,s=n.dataset.service;t&&shareSns(s,t.shareTitle,t.shareUrl,t.shareDesc)};return(0,s.jsx)("div",{className:"layerPopupWrap shareLayer ".concat(n?"on":""),children:(0,s.jsxs)("div",{className:"layerPopup",children:[(0,s.jsxs)("div",{className:"layerPopupHeader",children:[(0,s.jsx)("h2",{children:"공유하기"}),(0,s.jsx)("button",{type:"button",className:"btnClose",onClick:()=>a(!n),children:(0,s.jsx)("span",{className:"blind",children:"닫기"})})]}),(0,s.jsx)("div",{className:"layerPopupContent",children:(0,s.jsxs)("ul",{className:"shareList",children:[(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#none",className:"line","data-service":"line",onClick:share,children:"라인"})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#none",className:"twitter","data-service":"twitter",onClick:share,children:"트위터"})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#none",className:"facebook","data-service":"facebook",onClick:share,children:"페이스북"})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"#none",className:"url","data-service":"copyurl",onClick:share,children:"URL 복사"})})]})})]})})},error=()=>(0,s.jsx)("div",{className:"refresh fullDimmed",children:(0,s.jsxs)("div",{className:"innerWrap",children:[(0,s.jsxs)("span",{className:"text",children:["현재 방송 상태가 원활하지 않습니다.",(0,s.jsx)("br",{}),"잠시만 기다려주세요."]}),(0,s.jsx)("button",{type:"button",className:"btnRefresh",onClick:()=>{location.reload()},children:(0,s.jsx)("span",{children:"새로고침"})})]})}),end=()=>{let goSubHome=e=>{e.preventDefault(),window.parent.postMessage({message:{url:"",method:"goSubHome"}},"*")};return(0,s.jsx)("div",{className:"endGuide fullDimmed",children:(0,s.jsxs)("div",{className:"innerWrap",children:[(0,s.jsx)("span",{className:"text",children:"방송이 종료되었습니다."}),(0,s.jsx)("button",{type:"button",className:"btnSearch",onClick:e=>goSubHome(e),children:(0,s.jsx)("span",{children:"다른 방송 둘러보기"})})]})})},y=n(5968);let logClickBtnSound=e=>{window.InpkCommonTagManager.setDataLayerEvent("user_interaction",{event_name:"user_interaction",action_type:"click",section:"라이브플레이어_사운드",entity_name:null==e?void 0:e.scheduleTitle,entity_type:"button",feature_id:null==e?void 0:e.scheduleNum,feature_name:null==e?void 0:e.scheduleTitle,feature_category:"공통/공통/공통"})},logClickBtnShareSNS=e=>{window.InpkCommonTagManager.setDataLayerEvent("user_interaction",{event_name:"user_interaction",action_type:"click",section:"라이브플레이어_공유하기",entity_name:null==e?void 0:e.scheduleTitle,entity_type:"button",feature_id:null==e?void 0:e.scheduleNum,feature_name:null==e?void 0:e.scheduleTitle,feature_category:"공통/공통/공통"})},logClickBtnClose=e=>{window.InpkCommonTagManager.setDataLayerEvent("user_interaction",{event_name:"user_interaction",action_type:"click",section:"라이브플레이어_닫기",entity_name:null==e?void 0:e.scheduleTitle,entity_type:"button",feature_id:null==e?void 0:e.scheduleNum,feature_name:null==e?void 0:e.scheduleTitle,feature_category:"공통/공통/공통"})},logClickProduct=(e,t,n)=>{let s=new URL(t.targetProductLinkUrl).searchParams.get("exhibitionCode");window.InpkCommonTagManager.setDataLayerEvent("user_interaction",{event_name:"user_interaction",action_type:"click",section:"라이브플레이어_상품",entity_name:null==e?void 0:e.scheduleTitle,entity_type:"product",custom_dimension:JSON.stringify({position:n+1}),feature_id:null!=s?s:null==t?void 0:t.productNum,feature_name:null==t?void 0:t.targetProductName,feature_category:"공통/공통/공통"})},logClickBtnOthers=e=>{let{sectionTitle:t,scheduleTitle:n}=e;window.InpkCommonTagManager.setDataLayerEvent("user_interaction",{event_name:"user_interaction",action_type:"click",section:t,entity_name:n,entity_type:"button",feature_category:"공통/공통/공통"})};var header=e=>{let{liveChannel:t,videoPlayer:n,shareSns:i,isOpenChannelInfoLayer:r,setIsOpenChannelInfoLayer:o}=e,c=useAppDispatch(),[d,u]=(0,a.useState)(!1);l(e=>e.common.nowDate);let m=l(e=>e.liveTv.isExpand),p=l(e=>e.liveTv.isHorizon),h=l(e=>e.common.isApp),v=l(e=>e.liveTv.liveState),g=t.scheduleTitle?t.scheduleTitle:"",f=t.channelName?t.channelName:null,j=l(e=>e.liveTv.pipMode),b=l(e=>e.chat.pv),{show_share:y=1,show_user_count:C=1,show_room_title:k=1}=l(e=>e.room.roomInfo),onClickLiveClose=e=>{e.preventDefault(),logClickBtnClose(t),setTimeout(()=>{j?window.parent.postMessage({isLiveFloating:!1},"*"):window.parent.postMessage({message:{url:"",method:"historyBack"}},"*")},100)};return(0,a.useEffect)(()=>{!m&&n&&u(!n.muted())},[m]),(0,s.jsxs)("div",{className:"liveTvChannel",children:[(0,s.jsxs)("div",{className:"channelInfo",children:[(0,s.jsx)("span",{className:""}),(0,s.jsx)("span",{className:"label ".concat(v.toLowerCase()),children:v}),1===C&&v===x.LIVE&&(0,s.jsx)("p",{className:"view",children:numWithCommas(b)}),(0,s.jsx)("p",{className:"text",children:f})]}),(0,s.jsxs)("div",{className:"buttonWrap",children:[!j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",className:d?"btnMute":"btnMute off",onClick:()=>{u(!d),logClickBtnSound(t),setTimeout(()=>{window.parent.postMessage({message:{url:"",method:"changeMute",data:{muted:d,isPlaying:!n.paused()}}},"*"),d?n.muted(!0):n.muted(!1)},150)},children:(0,s.jsx)("span",{className:"blind",children:"음소거"})}),1===y&&(0,s.jsx)("button",{type:"button",className:"btnShare",onClick:i,children:(0,s.jsx)("span",{className:"blind",children:"공유하기"})}),h&&p&&(0,s.jsx)("button",{type:"button",className:m?"btnExpand on":"btnExpand",onClick:()=>{c(N._.setIsExpand(!m)),window.parent.postMessage({message:{data:m?"portrait":"landscape",method:"changeOrientation"}},"*")},children:(0,s.jsx)("span",{className:"blind",children:"전체보기"})})]}),(0,s.jsx)("button",{type:"button",className:"btnClose",onClick:e=>onClickLiveClose(e),children:(0,s.jsx)("span",{className:"blind",children:"라이브TV 닫기"})})]}),1===k&&(0,s.jsx)("h2",{className:"channelTitle",children:(0,s.jsx)("a",{href:"#none",className:"btnNotice",onClick:e=>{e.preventDefault(),o({visible:!r.visible,active:"guide"})},children:g})})]})},chat=e=>{let{liveState:t,playerLoading:n}=e,i=useAppDispatch(),r=l(e=>e.chat.nickName),o=l(e=>e.chat.chat.data),c=l(e=>e.chat.firstMsgId),d=l(e=>e.chat.payloadId),u=l(e=>e.chat.topic);l(e=>{var t,n;return null===(n=e.chat.noticeMessage.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message});let[m,p]=(0,a.useState)({page:1,pageHeight:0}),[h,v]=(0,a.useState)(!0),g=(0,a.useRef)(null),f=(0,a.useRef)(null),x=(0,a.useRef)(null),N=(0,a.useRef)(null),autoScrollHeight=()=>{if(f.current&&N.current){let e=m.pageHeight,t=x.current?x.current.clientHeight:0,n=t-e;0!==n&&(f.current.scrollTop=n)}},scrollNew=e=>{e.preventDefault();let t=x.current?x.current.clientHeight:0;f.current&&N.current&&(f.current.scrollTop=t,N.current.style.display="none",f.current.classList.remove("more")),v(!h)},onCheckScroll=()=>{if(g.current&&f.current&&N.current){let e=f.current.scrollTop,t=f.current.offsetHeight,n=f.current.scrollHeight,s=f.current.scrollTop;e+t>=n?(N.current.style.display="none",f.current.classList.remove("more")):(N.current.style.display="inline-block",f.current.classList.add("more")),0===s?g.current.classList.add("offsetTop"):g.current.classList.remove("offsetTop"),0===e&&updateChatList()}},updateChatList=()=>{let e=[];if(e.length>0){for(let t=0;t<e.length;t++)clearTimeout(e[t]);e=[]}e.push(setTimeout(()=>{p(e=>({page:e.page+1,pageHeight:x.current?x.current.clientHeight:0}))},800))};return(0,a.useEffect)(()=>(f.current&&f.current.addEventListener("scroll",onCheckScroll),()=>{f.current&&f.current.removeEventListener("scroll",onCheckScroll)}),[h]),(0,a.useEffect)(()=>{o&&autoScrollHeight()},[o]),(0,a.useEffect)(()=>{1!==m.page&&""!==u&&""!==c&&i(y.O.requestChatInfoAction())},[m.page,u,c,i]),(0,a.useEffect)(()=>{if(""!==d&&f.current&&N.current&&"inline-block"!==N.current.style.display){let{scrollHeight:e}=f.current;f.current.scrollTop=e}},[d]),(0,s.jsxs)("div",{className:"chattingArea",ref:g,children:[(0,s.jsx)("div",{className:"chattingList",ref:f,children:(0,s.jsx)("div",{className:"listInner",ref:x,children:o&&o.map((e,t)=>{let n=e.writer&&r===e.writer.user_nm?"myChat":e.data.viewType;if("notice"!==n&&e.data.message)return(0,s.jsxs)("div",{className:"chatUnit ".concat({normal:"",info:"manage",event:"event",notice:"notice",whisper:"",mutu:"",myChat:"myChat"}[n]),children:[e.writer&&(0,s.jsx)("span",{className:"name",children:e.writer.user_nm}),(0,s.jsx)("span",{className:"chat",dangerouslySetInnerHTML:{__html:e.data.message.length>0?e.data.message[0].body.replace(/(\n|\r|\r\n)/g,"<br/>"):""}})]},"msg_".concat(t,"_").concat(e._id))})})}),(0,s.jsx)("button",{type:"button",className:"btnNewChat",onClick:e=>scrollNew(e),ref:N,children:"새로운 채팅"})]})},noticeBanner=e=>{let{isOpenChannelInfoLayer:t,setIsOpenChannelInfoLayer:n}=e,a=l(e=>{var t,n;return null===(n=e.chat.noticeMessage.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message});return(0,s.jsx)("div",{className:"noticeBanner",children:(0,s.jsx)("button",{type:"button",className:"btnNotice",onClick:()=>{n({visible:!t.visible,active:"notice"})},children:a[0].body})})},product=e=>{let{productList:t,setIsOpenProductLayer:n}=e;l(e=>e.liveTv.liveChannel.data),l(e=>e.common.clientIp),l(e=>e.room.socket),l(e=>e.liveTv.liveState),l(e=>e.chat.userInfo);let a=t[0],i=((null==a?void 0:a.targetProductOriginPrice)-(null==a?void 0:a.targetProductPrice))/(null==a?void 0:a.targetProductOriginPrice)*100,openProduct=(e,t,n)=>{e.stopPropagation(),t&&window.parent.postMessage({message:{url:t,method:"openEachService",type:n}},"*")};return(0,s.jsx)("div",{className:"productArea",children:(0,s.jsxs)("div",{className:"productAreaInner",children:[(0,s.jsx)("div",{className:"prdItemArea",children:(0,s.jsx)("a",{href:"#",onClick:e=>openProduct(e,a.targetProductLinkUrl,a.targetProductService),children:(0,s.jsxs)("div",{className:"itemInner",children:[(0,s.jsx)("div",{className:"prdImg",children:(null==a?void 0:a.targetProductImageUrl)&&(0,s.jsx)("img",{src:getProtocolExceptURL(null==a?void 0:a.targetProductImageUrl),alt:""})}),(0,s.jsxs)("div",{className:"prdInfo",children:[(0,s.jsx)("div",{className:"title",children:null==a?void 0:a.targetProductName}),(0,s.jsxs)("div",{className:"priceArea",children:[Math.floor(i)>0&&(0,s.jsxs)("div",{className:"discountPercent",children:[(0,s.jsx)("span",{className:"num",children:Math.floor(i)}),"%"]}),(a.targetProductPrice>0||100===Math.floor(i))&&(0,s.jsxs)("div",{className:"discountPrice",children:[(0,s.jsx)("span",{className:"num",children:numWithCommas(null==a?void 0:a.targetProductPrice)}),"원"]})]})]})]})})}),t.length>1&&(0,s.jsx)("div",{className:"btnMoreArea",children:(0,s.jsxs)("button",{type:"button",className:"btnMore",onClick:()=>{n(!0)},children:[(0,s.jsxs)("em",{children:["+",t.length-1]}),(0,s.jsx)("span",{children:"더보기"})]})})]})})},C=n(1248),k=n.n(C),iconBanner=e=>{let{isOpenChannelInfoLayer:t,setIsOpenChannelInfoLayer:n,isOpenChattingBar:i,setIsOpenChattingBar:r,onClickLikeEventHandler:o,isOpenCouponLayer:c,setIsOpenCouponLayer:d}=e,u=(0,a.useRef)(null),m=(0,a.useRef)(null),p=l(e=>e.room.roomInfo.userInteractionInfo),h=l(e=>e.liveTv.liveChannel.data),{show_like:v,show_live_info:g,show_chat:f,show_coupon:x}=l(e=>e.room.roomInfo),N=null==p?void 0:p.user_like;l(e=>{var t;return(null===(t=e.room.roomInfo.adminInteractionInfo.coupons)||void 0===t?void 0:t.filter(e=>e.status>0).length)||0});let j=l(e=>e.chat.userInfo),b=l(e=>e.room.socket),y=(0,a.useMemo)(()=>({container:u.current,renderer:"svg",loop:!1,autoplay:!1,path:"/lotties/likeAnimation.json"}),[u.current]),C=(0,a.useMemo)(()=>({container:m.current,renderer:"svg",loop:!1,autoplay:!1,path:"/lotties/clickAnimation.json"}),[m.current]),initialLoadAnimation=()=>{var e;let t=k().loadAnimation(y);t.goToAndPlay(0,!0),null===(e=m.current)||void 0===e||e.setAttribute("class","clickAnimation active");let n=k().loadAnimation(C);n.goToAndPlay(0,!0),setTimeout(()=>{var e,t,n;null===(e=u.current)||void 0===e||e.removeChild(u.current.children[0]),null===(t=m.current)||void 0===t||t.removeChild(m.current.children[0]),null===(n=m.current)||void 0===n||n.setAttribute("class","clickAnimation")},1500),o(b)};return(0,s.jsxs)("div",{className:"buttonWrap",children:[(0,s.jsx)("div",{className:"btnLikeWrap",children:1===v&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{type:"button",className:"btnLike",onClick:()=>{h&&logClickBtnOthers({sectionTitle:"라이브플레이어_라이크",scheduleTitle:null==h?void 0:h.scheduleTitle}),initialLoadAnimation()},children:[(0,s.jsx)("span",{className:"blind",children:"좋아요"}),(0,s.jsx)("span",{className:"count",children:N>=1e4?"".concat(Math.round(N/1e3)/10,"만"):numWithCommas(N)})]}),(0,s.jsx)("div",{className:"likeAnimation",ref:u}),(0,s.jsx)("div",{className:"clickAnimation",ref:m})]})}),1===g&&(0,s.jsx)("button",{type:"button",className:"btnNotice",onClick:()=>{h&&logClickBtnOthers({sectionTitle:"라이브플레이어_인포",scheduleTitle:null==h?void 0:h.scheduleTitle}),n({visible:!t.visible,active:"notice"})},children:(0,s.jsx)("span",{className:"blind",children:"공지사항"})}),1===f&&(0,s.jsx)("button",{type:"button",className:"btnChat",onClick:e=>{if(e.stopPropagation(),!j.memNo)return window.parent.postMessage({message:{url:"https://accounts.interpark.com/authorize/interpark-mweb",method:"openLogin"}},"*"),!1;r(!i)},children:(0,s.jsx)("span",{className:"blind",children:"채팅"})})]})},chattingBar=e=>{let{setIsOpenNickName:t,isOpenNickName:n,nickName:i,liveState:r,topic:o,mqttPublish:c}=e,d=(0,a.useRef)(null),[u,m]=(0,a.useState)(!1),[p,h]=(0,a.useState)(""),v=l(e=>e.chat.userInfo),sendMsg=e=>{if(d.current){if(""===d.current.value.trim())return e.preventDefault(),!1;if(!i&&r===x.LIVE)return t(!n),!1;i&&c(o,d.current.value,i,"normal"),e.preventDefault(),d.current.value="",d.current.focus(),h(""),m(!1)}},handleFocus=e=>(e.preventDefault(),v.memNo)?v.memNo&&r===x.LIVE&&!i?(t(!n),!1):void(d.current&&(d.current.value="",d.current.focus())):(window.parent.postMessage({message:{url:"https://accounts.interpark.com/authorize/interpark-mweb",method:"openLogin"}},"*"),e.target.blur(),!1);return(0,a.useEffect)(()=>{d.current&&(d.current.value="",d.current.focus())},[]),(0,s.jsxs)("div",{className:"inpTextWrap ".concat(u?"active":""),children:[(0,s.jsx)("div",{className:"inpTextBox",children:(0,s.jsx)("textarea",{className:"inpText",placeholder:"실시간 대화에 참여하세요",title:"실시간 대화에 참여하세요",defaultValue:"",ref:d,onFocus:e=>handleFocus(e),onKeyPress:e=>{var t,n;let s="";if(void 0!==e.key?s=e.key:void 0!==e.keyIdentifier?s=e.keyIdentifier:void 0!==e.keyCode&&(s=e.keyCode),(null===(t=d.current)||void 0===t?void 0:t.value.trim())===""&&("Space"===s||"Enter"===s))return d.current.value=null===(n=d.current)||void 0===n?void 0:n.value.trim(),e.preventDefault(),!1;if("Enter"===s&&d.current){if(""===d.current.value.trim())return e.preventDefault(),!1;sendMsg(e)}},value:p,onChange:e=>{h(e.target.value),e.target.value.trim()?m(!0):m(!1)}})}),(0,s.jsx)("button",{type:"button",className:"btnNickName",onClick:()=>{if(!v.memNo)return window.parent.postMessage({message:{url:"https://accounts.interpark.com/authorize/interpark-mweb",method:"openLogin"}},"*"),!1;t(!n)},children:(0,s.jsx)("span",{className:"blind",children:"닉네임변경"})}),(0,s.jsx)("button",{type:"button",className:"btnSubmit",onClick:sendMsg,children:"보내기"})]})},liveTvInfo=e=>{let{liveChannel:t,liveState:n,playerLoading:a,isOpenChannelInfoLayer:i,setIsOpenChannelInfoLayer:r,setIsOpenProductLayer:o,isOpenChattingBar:c,setIsOpenChattingBar:d,onClickLikeEventHandler:u,isOpenCouponLayer:m,setIsOpenCouponLayer:p,mqttPublish:h,mqttUserUpdatePublish:v,isOpenNickName:g,setIsOpenNickName:f}=e,N=l(e=>e.room.socket),j=l(e=>{var t;return isEmptyObj(N)||1!==e.room.roomInfo.show_product?(null===(t=e.liveTv.liveChannel.data)||void 0===t?void 0:t.productList)||[]:e.room.roomInfo.adminInteractionInfo.products.filter(e=>e.status>0)}),b=l(e=>e.chat.nickName),y=l(e=>{var t,n;return null===(n=e.chat.noticeMessage.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message}),C=t?t.chatRoomId:"",{show_room_notice:k,show_product:I}=l(e=>e.room.roomInfo);return(0,s.jsxs)("div",{className:"liveTvInfoWrap",children:[(0,s.jsxs)("div",{className:"liveTvInfoLeft",children:[n===x.LIVE&&(0,s.jsx)(chat,{liveState:n,playerLoading:a}),1===k&&y&&(0,s.jsx)(noticeBanner,{isOpenChannelInfoLayer:i,setIsOpenChannelInfoLayer:r}),j&&(null==j?void 0:j.length)>0&&1===I&&(0,s.jsx)(product,{productList:j,setIsOpenProductLayer:o})]}),(0,s.jsx)("div",{className:"liveTvInfoRight",children:(0,s.jsx)(iconBanner,{isOpenChannelInfoLayer:i,setIsOpenChannelInfoLayer:r,isOpenChattingBar:c,setIsOpenChattingBar:d,onClickLikeEventHandler:u,isOpenCouponLayer:m,setIsOpenCouponLayer:p})}),a&&n===x.LIVE&&(0,s.jsx)(chattingBar,{setIsOpenNickName:f,isOpenNickName:g,nickName:b,liveState:n,topic:C,mqttPublish:h})]})},productItem=e=>{let{product:t,index:n}=e,a=l(e=>e.liveTv.liveChannel.data);l(e=>e.common.clientIp),l(e=>e.room.socket),l(e=>e.chat.userInfo),l(e=>e.liveTv.liveState);let i=(t.targetProductOriginPrice-t.targetProductPrice)/t.targetProductOriginPrice*100,openProduct=(e,s,i)=>{e.stopPropagation(),a&&(logClickProduct(a,t,n),setTimeout(()=>{s&&window.parent.postMessage({message:{url:s,method:"openEachService",type:i}},"*")},100))};return(0,s.jsx)("div",{className:"prdItemArea",children:(0,s.jsx)("a",{href:"#none",onClick:e=>openProduct(e,t.targetProductLinkUrl,t.targetProductService),children:(0,s.jsxs)("div",{className:"itemInner",children:[(0,s.jsx)("div",{className:"prdImg",children:(null==t?void 0:t.targetProductImageUrl)&&(0,s.jsx)("img",{src:getProtocolExceptURL(t.targetProductImageUrl),alt:""})}),(0,s.jsxs)("div",{className:"prdInfo",children:[(0,s.jsx)("div",{className:"title",children:t.targetProductName}),(0,s.jsxs)("div",{className:"priceArea",children:[t.targetProductOriginPrice>0&&Math.floor(i)>=0&&(0,s.jsxs)("div",{className:"originalPrice",children:[(0,s.jsx)("span",{className:"num",children:numWithCommas(t.targetProductOriginPrice)}),"원"]}),(0,s.jsxs)("div",{className:"discount",children:[Math.floor(i)>0&&(0,s.jsxs)("div",{className:"discountPercent",children:[(0,s.jsx)("span",{className:"num",children:Math.floor(i)}),"%"]}),(t.targetProductPrice>0||100===Math.floor(i))&&(0,s.jsxs)("div",{className:"discountPrice",children:[(0,s.jsx)("span",{className:"num",children:numWithCommas(t.targetProductPrice)}),"원"]})]})]})]})]})})})},product_ProductLayer=e=>{let{isOpenProductLayer:t,setIsOpenProductLayer:n}=e,a=l(e=>e.room.socket),i=l(e=>{var t;return isEmptyObj(a)||1!==e.room.roomInfo.show_product?(null===(t=e.liveTv.liveChannel.data)||void 0===t?void 0:t.productList)||[]:e.room.roomInfo.adminInteractionInfo.products.filter(e=>e.status>0)});return(0,s.jsx)("div",{className:"bottomLayerWrap productLayer ".concat(t?"on":""),onClick:()=>{n(!t)},children:(0,s.jsxs)("div",{className:"bottomLayer",children:[(0,s.jsx)("div",{className:"listHeader",children:(0,s.jsx)("button",{type:"button",className:"btnLayerClose",onClick:()=>{n(!t)},children:(0,s.jsx)("span",{className:"blind",children:"레이어 닫기"})})}),(0,s.jsxs)("div",{className:"listContent",children:[(0,s.jsx)("div",{className:"contentTitle",children:(0,s.jsxs)("h2",{children:["판매상품",(0,s.jsx)("em",{children:null==i?void 0:i.length})]})}),(0,s.jsx)("div",{className:"contentWrap",children:(0,s.jsx)("ul",{className:"listPrd",children:null==i?void 0:i.map((e,t)=>(0,s.jsx)("li",{children:(0,s.jsx)(productItem,{product:e,index:t})},e.productNum))})})]})]})})},loading=()=>(0,s.jsx)("div",{className:"fullDimmed loading",children:(0,s.jsx)("i",{className:"loading"})}),eventBanner=e=>{let{onClickBannerEventHandler:t,mqttPublish:n,isOpenNickName:i,setIsOpenNickName:o}=e,[c,d]=(0,a.useState)(!1),u=l(e=>e.chat.nickName);l(e=>e.liveTv.liveChannel.data),l(e=>e.room.socket);let m=l(e=>e.chat.userInfo);l(e=>e.common.clientIp),l(e=>e.liveTv.liveState);let p=l(e=>e.chat.topic),h=l(e=>{var t;return(null===(t=e.room.roomInfo.adminInteractionInfo.banners)||void 0===t?void 0:t.filter(e=>e.status>0))||[]}),v=h[0],onClickBannerUrl=(e,t,s)=>{e.stopPropagation();let a=t;if(r.tq&&(a=s),a){if(isExceptURL(a))window.parent.postMessage({message:{url:a,method:"openEachService",type:"default"}},"*");else if(a.startsWith("eventmessage://")){if(!m.memNo)return window.parent.postMessage({message:{url:"https://accounts.interpark.com/authorize/interpark-mweb",method:"openLogin"}},"*"),!1;u?(n(p,a.replace("eventmessage://",""),u,"normal"),d(!1)):o(!0)}}};return(0,a.useEffect)(()=>{v?d(!0):d(!1)},[v]),(0,s.jsx)("div",{className:"layerPopupWrap bannerPopup ".concat(c?"on":""),onClick:e=>{e.preventDefault(),d(!c)},children:(0,s.jsxs)("div",{className:"layerPopup",children:[(0,s.jsx)("button",{type:"button",className:"btnClose",onClick:e=>{e.preventDefault(),d(!c)},children:(0,s.jsx)("span",{className:"blind",children:"닫기"})}),(0,s.jsx)("div",{className:"eventBanner",onClick:e=>onClickBannerUrl(e,v.bannerUrl,v.bannerUrlM),children:v&&(0,s.jsx)("a",{href:"#none",children:v.bannerImg&&(0,s.jsx)("img",{src:getProtocolExceptURL(v.bannerImg),alt:""})})})]})})},I=n(1616),_=n.n(I),w=n(2474),hooks_useMqtt=()=>{let e=useAppDispatch(),t=l(e=>e.common.token),n=l(e=>e.chat.userInfo),s=l(e=>e.chat.user.data),i=l(e=>e.chat.nickName),o=l(e=>e.chat.topic),d=l(e=>e.liveTv.pipMode),[u,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),v="mqtts://ichat.interpark.com/wss",encrypt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chatbot",n=(0,w.createCipher)("aes-256-cbc",t);return n.update(e,"utf8","base64")+n.final("base64")},mqttSub=e=>{u&&(h({topic:e}),u.subscribe(e,e=>{if(e){console.log("Subscribe to topics error",e);return}}))};return(0,a.useEffect)(()=>{o&&u&&mqttSub(o)},[o,u]),(0,a.useEffect)(()=>{if(!d){let e=sessionStorage.getItem("liveDeviceKey"),a=e;if(!e){let e=c()().format("YYYYMMDDhhmmss"),t=Math.random();sessionStorage.setItem("liveDeviceKey","".concat(e).concat(t)),a="".concat(e).concat(t)}console.log({deviceKey:a});let l={keepalive:50,clean:!0,connectTimeout:6e4,clientId:"guest::::".concat(a),nl:!0,username:"ichat",password:"ichat"};if(s&&null!==s.MEM_NO&&t){let e=i||"";l.clientId="member:".concat(s.MEM_NO,":").concat(e,":").concat(n.id,":").concat(a),l.username=JSON.stringify({app_id:"shop",app_os:r.tq?"mw":"w",app_pkg:r.tq?r.gn?"ios":"android":"pc",app_domain:"",app_ver:"",com_id:"interpark"}),l.password=s.PASSWORD}u?console.log(u):t?s&&null!==s.MEM_NO&&(m(_().connect(v,l)),console.log("connect")):(m(_().connect(v,l)),console.log("connect"))}},[s,d]),(0,a.useEffect)(()=>(u&&p&&(u.connected||console.log("connect"),u.on("connect",()=>{console.log("Connected")}),u.on("error",e=>{console.error("Connection error: ",e),u.end()}),u.on("reconnect",()=>{console.log("Reconnecting")}),u.on("message",(t,n)=>{let s=JSON.parse(n.toString());"action.custom"===s.cmd&&e(y.O.setPageView(s.data.body.pv)),s.room_id&&s.room_id!==p.topic&&"private"!==s.room_id||"user.update"===s.cmd||"room.update"===s.cmd||"msg.delete"===s.cmd||("notice"===s.data.viewType&&e(y.O.setNoticeMessage(s)),e(y.O.setMessage(s)))})),()=>{u&&p&&u.end()}),[u,p]),{mqttPublish:(e,t,s,a)=>{let i=n.memNo,l=n.id,r=encrypt(i,"khRi9kB9Q1-".concat(e)),o=encrypt(l,"khRi9kB9Q1-".concat(e));if(u){let{topic:n,payload:i}={topic:e,payload:{cmd:"msg.write",data:{viewType:a,message:[{type:"text",body:t}]},room_id:e,writer:{user_nm:s},writer_enc:{user_no:r,user_id:o}}};u.publish(n,JSON.stringify(i),e=>{e&&console.log("Publish error: ",e)})}},mqttUserUpdatePublish:(e,t)=>{if(u){let{topic:n,payload:s}={topic:e,payload:{cmd:"user.update",data:{name:t},room_id:e}};u.publish(n,JSON.stringify(s),e=>{e&&console.log("Publish error: ",e)})}}}},nickName=e=>{let{isOpenNickName:t,setIsOpenNickName:n,mqttUserUpdatePublish:i}=e,r=useAppDispatch(),o=l(e=>e.chat.userNameCheck.data),c=l(e=>e.chat.nickName),d=l(e=>e.chat.topic),u=(0,a.useRef)(null),[m,p]=(0,a.useState)({code:-1,message:""}),[h,v]=(0,a.useState)(c),nameCheckValidation=()=>{if(u.current){let e=u.current.value.trim();return""!==e||(p({...m,message:"닉네임을 입력해주세요"}),!1)}};return(0,a.useEffect)(()=>{var e;o&&(null===(e=u.current)||void 0===e?void 0:e.value)&&p(o)},[o]),(0,s.jsx)("div",{id:"alertNickname",role:"alertdialog",className:"layerAlert nickNamePopup ".concat(t?"active":""),children:(0,s.jsxs)("div",{className:"layerAlertConfirm",children:[(0,s.jsx)("div",{className:"layerAlertContent",children:(0,s.jsxs)("div",{className:"nickNameContent",children:[(0,s.jsx)("h2",{className:"title",children:"닉네임 설정 및 변경"}),(0,s.jsx)("p",{className:"text",children:"닉네임은 10자 이내로 입력해 주세요"}),(0,s.jsxs)("div",{className:"inpArea",children:[(0,s.jsx)("input",{type:"text",className:"inputText",ref:u}),(0,s.jsx)("button",{type:"button",className:"btnCheck",onClick:()=>{nameCheckValidation()&&u.current&&(r(y.O.setNickName(u.current.value.trim())),r(y.O.requestUseNameCheckAction()))},children:"중복확인"})]}),(0,s.jsx)("p",{className:"certifyArea",children:m.message})]})}),(0,s.jsxs)("div",{className:"layerAlertBtnWrap",children:[(0,s.jsx)("button",{type:"button",className:"layerAlertBtn btnCancle",onClick:()=>{r(y.O.setNickName(h||"")),n(!t)},children:"취소"}),(0,s.jsx)("button",{type:"button",className:"layerAlertBtn btnConfirm",onClick:()=>{if(!nameCheckValidation())return!1;if(u.current){if(c!==u.current.value.trim()||-1===m.code)return p({...m,message:"중복확인 바랍니다"}),!1;1!==m.code&&(r(y.O.requestSetUserInfoAction()),i(d,c),n(!t))}},children:"확인"})]})]})})},live=e=>{let{liveChannel:t,shareSns:n,setIsOpenShareSns:i,isOpenShareSns:r,setIsOpenChattingBar:o,isOpenChattingBar:c,onClickLikeEventHandler:d,onClickBannerEventHandler:u,isOnReadyViewClass:m,setIsOnReadyViewClass:p}=e,h=useAppDispatch(),[v,g]=(0,a.useState)({visible:!1,active:"notice"}),[f,j]=(0,a.useState)(!1),[b,C]=(0,a.useState)(!1),[k,I]=(0,a.useState)(!1),[_,w]=(0,a.useState)(!1),[S,T]=(0,a.useState)(!1),[L,E]=(0,a.useState)(!1),[P,O]=(0,a.useState)(!1),[M,D]=(0,a.useState)(null),A=l(e=>e.chat.user.data),R=l(e=>e.common.token),H=l(e=>e.liveTv.liveState),{show_banner:B}=l(e=>e.room.roomInfo),{mqttPublish:U,mqttUserUpdatePublish:V}=hooks_useMqtt(),q=t?t.chatRoomId:"";return(0,a.useEffect)(()=>{window.addEventListener("message",e=>{let t=e.data.message;t&&("pipMode"===t.type?(h(N._.setIsContentHide(t.data.pipMode)),h(N._.setIsExpand(t.data.orientationType)),console.error({orientationType:t.data.orientationType}),j(!1),g({visible:!1,active:"notice"}),I(!0)):"playBroadcast"===t.type?M&&(console.log("play"),M.play()):"requestPlayer"===t.type&&(I(!1),M&&M.paused()&&M.play()))},!1)},[M]),(0,a.useEffect)(()=>{t?(h(y.O.setTopic(q)),h(y.O.requestUserInfoAction())):T(!0)},[t,q,h]),(0,a.useEffect)(()=>{A&&null!==A.MEM_NO&&void 0!==A.NAME&&R&&h(y.O.setNickName(A.NAME))},[A,h]),(0,a.useEffect)(()=>{A&&q&&h(y.O.requestRoomInfoAction())},[A,q,h]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(header,{liveChannel:t,videoPlayer:M,shareSns:n,isOpenChannelInfoLayer:v,setIsOpenChannelInfoLayer:g}),(0,s.jsx)(live_video,{liveChannel:t,setErrorPlayer:T,setPlayerLoading:E,setVideoPlayer:D,setVideoLoading:O,playerLoading:L,isOnReadyViewClass:m,setIsOnReadyViewClass:p}),!P&&(0,s.jsx)(liveTvInfo,{liveChannel:t,liveState:H,playerLoading:L,isOpenChannelInfoLayer:v,setIsOpenChannelInfoLayer:g,setIsOpenProductLayer:j,isOpenChattingBar:c,setIsOpenChattingBar:o,onClickLikeEventHandler:d,isOpenCouponLayer:b,setIsOpenCouponLayer:C,mqttPublish:U,mqttUserUpdatePublish:V,isOpenNickName:_,setIsOpenNickName:w}),L&&1===B&&!k&&(0,s.jsx)(eventBanner,{onClickBannerEventHandler:u,mqttPublish:U,isOpenNickName:_,setIsOpenNickName:w}),(0,s.jsx)(common_shareSns,{liveChannel:t,isOpenShareSns:r,setIsOpenShareSns:i}),(0,s.jsx)(product_ProductLayer,{isOpenProductLayer:f,setIsOpenProductLayer:j}),(0,s.jsx)(channelInfoLayer,{isOpenChannelInfoLayer:v,setIsOpenChannelInfoLayer:g,liveChannel:t}),_&&(0,s.jsx)(nickName,{isOpenNickName:_,setIsOpenNickName:w,mqttUserUpdatePublish:V}),H!==x.END&&S&&(0,s.jsx)(error,{}),H===x.END&&(0,s.jsx)(end,{}),H!==x.END&&!S&&P&&(0,s.jsx)(loading,{})]})},hooks_useInterval=(e,t)=>{let n=(0,a.useRef)(null);(0,a.useEffect)(()=>{n.current=e},[e]),(0,a.useEffect)(()=>{let e=setInterval(()=>{n.current&&n.current()},t);return()=>clearInterval(e)},[])},S=n(2599),T=n(726),hooks_useConsoleSocket=()=>{let e=useAppDispatch(),t=l(e=>e.chat.nickName),n=l(e=>e.chat.userInfo),s=l(e=>{var t;return null===(t=e.liveTv.liveChannel.data)||void 0===t?void 0:t.chatRoomId}),i=l(e=>e.room.roomInfo),r=l(e=>e.liveTv.pipMode),[o,c]=(0,a.useState)(null),initializeConnect=()=>{let a={transports:["websocket"],autoConnect:!0,query:{r:s,u:n.memNo?n.memNo:"GUEST",n:t}},i=(0,S.ZP)("https://chat-sub.inpk.io",a);c(i),e(T.C.setSocket(i))},d=(0,a.useCallback)(t=>{e(T.C.updateRoomInfo(t))},[i]),u=(0,a.useCallback)(e=>{e&&(null==e||e.emit("like_click"))},[o]),m=(0,a.useCallback)((e,t)=>{e&&(null==e||e.emit("banner_click",t))},[o]),p=(0,a.useCallback)(()=>{o&&(null==o||o.emit("message"))},[o]);return(0,a.useEffect)(()=>{s&&!r&&initializeConnect()},[s,r]),(0,a.useEffect)(()=>(o&&!r&&(o.on("connect_error",function(e){console.log("connect_error",e)}),o.on("connect_timeout",function(){console.log("connect_timeout")}),o.on("error",function(e){console.log("error",e)}),o.on("reconnect",function(e){console.log("reconnect",e)}),o.on("reconnect_attempt",function(e){console.log("reconnect_attempt",e)}),o.on("reconnecting",function(e){console.log("reconnecting",e)}),o.on("reconnect_error",function(e){console.log("reconnect_error")}),o.on("reconnect_failed",function(){console.log("reconnect_failed")}),o.on("command",e=>{console.log("command : ",e)}),o.on("message",e=>{console.log("message : ",e)}),o.on("history_message",e=>{console.log("history_message : ",e)}),o.on("like",e=>{console.log("like : ",e)}),o.on("room_info",t=>{e(T.C.successRoomInfoAction(t))}),o.on("getout",e=>{console.log("getout : ",e)}),o.on("connect",()=>{console.log("useConsole connect : ")})),o&&i.room_id&&(o.on("update_room_info",e=>{d(e)}),o.on("queuemessage",t=>{e(T.C.updateUserInteractionInfoQueuemessage(t))}),o.emit("chat_init")),()=>{o&&i.room_id&&o.on("disconnect",()=>{console.log("socket disconnect")})}),[o,i.room_id,r]),{onClickLikeEventHandler:u,onClickBannerEventHandler:m,onSendMessageEventHandler:p}},previewThumb=e=>{let{liveChannel:t,shareSns:n,setIsOpenShareSns:a,isOpenShareSns:i,setIsOpenPhotoDetail:o,isOpenPhotoDetail:d}=e;l(e=>e.liveTv.liveState);let u=t.previewImageList.length>0,m=u?t.previewImageList[0].previewImage:"",p=t.liveStartTime?c()(t.liveStartTime).format("M월 D일 HH:mm"):"",h=t.scheduleTitle?t.scheduleTitle:"",v=t.channelName?t.channelName:null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"previewThumb",children:[(0,s.jsxs)("div",{className:"buttonWrap",children:[(0,s.jsx)("button",{type:"button",className:"btnShare",onClick:n,children:(0,s.jsx)("span",{className:"blind",children:"공유하기"})}),(0,s.jsx)("button",{type:"button",className:"btnClose",onClick:e=>{e.preventDefault(),window.parent.postMessage({message:{url:"",method:"historyBack"}},"*")},children:(0,s.jsx)("span",{className:"blind",children:"닫기"})})]}),(0,s.jsx)("div",{className:"previewThumbImage",children:u&&(0,s.jsx)("img",{src:getProtocolExceptURL(m),alt:""})}),(0,s.jsxs)("div",{className:"previewThumbInfo",children:[(0,s.jsxs)("p",{className:"liveDate",children:[(0,s.jsx)("em",{children:p}),(0,s.jsx)("span",{className:"badge",children:"방송예정"})]}),(0,s.jsx)("p",{className:"liveTitle",children:h}),(0,s.jsx)("p",{className:"liveName",children:v}),u&&(0,s.jsx)("button",{type:"button",className:"btnPhotoDetail",onClick:e=>{e.preventDefault(),r.tq,o(!d)},children:(0,s.jsx)("span",{className:"blind",children:"이미지 상세보기"})})]})]}),(0,s.jsx)(common_shareSns,{liveChannel:t,isOpenShareSns:i,setIsOpenShareSns:a})]})},previewContent=e=>{let{liveChannel:t}=e,[n,i]=(0,a.useState)(!1),[r,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),u=l(e=>e.room.socket),m=l(e=>{var t;return isEmptyObj(u)||1!==e.room.roomInfo.show_product?(null===(t=e.liveTv.liveChannel.data)||void 0===t?void 0:t.productList)||[]:e.room.roomInfo.adminInteractionInfo.products.filter(e=>e.status>0)}),p=l(e=>1===e.room.roomInfo.show_coupon?e.room.roomInfo.adminInteractionInfo.coupons.filter(e=>e.status>0):[]),h=t.liveInfo?t.liveInfo.split("\n"):null,v=(0,a.useCallback)(e=>{e.preventDefault(),i(!n)},[n]),g=(0,a.useCallback)(e=>{e.preventDefault(),o(!r)},[r]),f=(0,a.useCallback)(e=>{e.preventDefault(),d(!c)},[c]);(0,a.useCallback)(e=>{e.preventDefault(),d(!c)},[c]);let x=(0,a.useMemo)(()=>{let e;let t=0===m.length,a=m.length>=2;return t?(0,s.jsxs)("div",{className:"emptyWrap",children:[(0,s.jsx)("strong",{className:"emptyTitle",children:"상품을 준비중입니다."}),(0,s.jsx)("p",{className:"emptyText",children:"조금만 기다려주세요."})]}):(e=m.map((e,t)=>(0,s.jsx)("li",{className:a?"":"first",children:(0,s.jsx)(productItem,{product:e,index:t})},e.productNum)),(0,s.jsxs)("div",{className:"prdItemWrap ".concat(n?"open":""," "),children:[(0,s.jsx)("h2",{className:"title",children:"판매 상품"}),(0,s.jsx)("ul",{className:"prdItemList",children:e}),m.length>2&&(0,s.jsx)("button",{type:"button",className:"btnDetail",onClick:v,children:(0,s.jsx)("span",{children:n?"상품 접기":"상품 더보기"})})]}))},[m,n]);(0,a.useMemo)(()=>{if(p.length>0){let e=p[0],{couponInfo:t,couponTitle:n}=e;return(0,s.jsxs)("div",{className:"coupon","data-alert":"#alertCoupon",onClick:f,children:[(0,s.jsxs)("h2",{children:[(0,s.jsx)("em",{children:t})," 할인쿠폰"]}),(0,s.jsx)("p",{children:n})]})}},[p]);let N=(0,a.useMemo)(()=>h?(0,s.jsxs)("div",{className:"liveNoticeWrap ".concat(r?" open":""),children:[(0,s.jsx)("h2",{className:"title",children:"라이브 안내"}),(0,s.jsx)("div",{className:"liveNotice",children:h.map((e,t)=>{let n=t===h.length?(0,s.jsx)(a.Fragment,{children:e},t):(0,s.jsxs)(a.Fragment,{children:[e,(0,s.jsx)("br",{})]},t);return n})}),t.liveInfo.length>=500&&(0,s.jsx)("button",{type:"button",className:"btnDetail",onClick:g,children:(0,s.jsx)("span",{children:r?"라이브 안내 접기":"라이브 안내 더보기"})})]}):(0,s.jsxs)("div",{className:"emptyWrap",children:[(0,s.jsx)("strong",{className:"emptyTitle",children:"라이브 안내 준비중입니다."}),(0,s.jsx)("p",{className:"emptyText",children:"조금만 기다려주세요."})]}),[h,r]);return(0,s.jsxs)("div",{className:"previewContentWrap",children:[(0,s.jsx)("div",{className:"previewContent",children:x}),(0,s.jsx)("div",{className:"previewContent",children:N})]})},previewPhotoDetail=e=>{let{previewImageList:t,setIsOpenPhotoDetail:n,isOpenPhotoDetail:a}=e;return(0,s.jsxs)("section",{className:"photoDetail",children:[(0,s.jsxs)("header",{className:"detailHeader",children:[(0,s.jsx)("h2",{children:"이미지 상세"}),(0,s.jsx)("button",{type:"button",className:"btnCloseDetail",onClick:()=>{n(!a)},children:(0,s.jsx)("span",{className:"blind",children:"닫기"})})]}),(0,s.jsx)("div",{className:"detailContent",children:(0,s.jsx)("ul",{className:"photoList",children:null==t?void 0:t.map(e=>(0,s.jsx)("li",{className:"item",children:(0,s.jsx)("img",{src:getProtocolExceptURL(e.previewImage),alt:""})},e.previewNum))})})]})},previewLive=e=>{let{liveChannel:t,shareSns:n,setIsOpenShareSns:i,isOpenShareSns:l}=e,[r,o]=(0,a.useState)(!1),c=t.previewImageList?t.previewImageList:[];return(0,a.useEffect)(()=>{window.scrollTo({top:0})},[r]),(0,s.jsx)(s.Fragment,{children:r?(0,s.jsx)(a.Suspense,{fallback:!0,children:(0,s.jsx)(previewPhotoDetail,{previewImageList:c,isOpenPhotoDetail:r,setIsOpenPhotoDetail:o})}):(0,s.jsxs)("section",{className:"previewLive",children:[(0,s.jsx)(previewThumb,{liveChannel:t,shareSns:n,setIsOpenShareSns:i,isOpenShareSns:l,setIsOpenPhotoDetail:o,isOpenPhotoDetail:r}),(0,s.jsx)(previewContent,{liveChannel:t})]})})},components=e=>{let{viewStatus:t}=e,n=useAppDispatch(),i=l(e=>e.liveTv.liveChannel.data),o=l(e=>e.liveTv.liveState),d=l(e=>e.common.nowDate),u=l(e=>e.liveTv.isExpand),m=l(e=>e.liveTv.isHorizon),p=l(e=>e.liveTv.isVertical),h=l(e=>e.liveTv.isContentHide),v=l(e=>e.chat.userInfo);l(e=>e.common.clientIp);let g=l(e=>e.room.socket),f=(l(e=>e.chat.nickName),l(e=>e.liveTv.pipMode)),[j,b]=(0,a.useState)(!1),[y,C]=(0,a.useState)("liveTvTobe"),[k,I]=(0,a.useState)(null),[_,w]=(0,a.useState)(!1),[S,T]=(0,a.useState)(!1),{onClickLikeEventHandler:L,onClickBannerEventHandler:E}=hooks_useConsoleSocket();null==i||i.companyNum,null==i||i.channelNum,null==i||i.scheduleNum,g.id,v.memNo&&v.memNo,c()().format();let shareSns=()=>{i&&(logClickBtnShareSNS(i),setTimeout(()=>{r.tq?window.parent.postMessage({message:{url:"",method:"shareSNS"}},"*"):b(!j)},150))},P=(0,a.useCallback)(()=>{let e="";if(e=t||(i?setChannelLiveStatus(i,d):""),n(N._.setLiveState(e)),e===x.PREVIEW){let e=document.getElementById("liveTvVideo"),t=null==e?void 0:e.getAttribute("class");t+=" preview",null==e||e.setAttribute("class",t||"")}if(i){let t=e===x.PREVIEW?(0,s.jsx)(previewLive,{liveChannel:i,shareSns:shareSns,setIsOpenShareSns:b,isOpenShareSns:j}):(0,s.jsx)(live,{liveChannel:i,shareSns:shareSns,setIsOpenShareSns:b,isOpenShareSns:j,isOpenChattingBar:_,setIsOpenChattingBar:w,onClickLikeEventHandler:L,onClickBannerEventHandler:E,isOnReadyViewClass:S,setIsOnReadyViewClass:T});I(t)}},[j,i,d]);return hooks_useInterval(()=>{},6e4),(0,a.useEffect)(()=>{let e="liveTvTobe";if(S&&o!==x.PREVIEW){if(m&&(e="".concat(e," ").concat("videoHorizon")),u){let t=r.gn?"landscape ios":"landscape";e="".concat(e," ").concat(t)}if(p){let t=r.tq?"verticalVideo":"";e="".concat(e," ").concat(t)}}o===x.VOD?e+=" noLive":o===x.END&&(e+=" end"),C(e)},[S,o,p,m,u]),(0,a.useEffect)(()=>{g.id},[g.id]),(0,a.useEffect)(()=>{P()},[j,i,d,t]),(0,s.jsx)(s.Fragment,{children:i&&(0,s.jsx)("div",{id:"",className:"".concat(y," ").concat(h?"contentHide":f&&"pipMode contentHide"," "),children:(0,s.jsx)("div",{className:"liveTvContent ".concat(_?"chatOpen":""," "),onClick:e=>{e.target.closest(".inpTextWrap")||e.target.closest(".layerAlert")||"btnNewChat"===e.target.className||w(!1)},children:k})})})};c().extend(v()),c().extend(f());var L=!0,_channelNo_=e=>{let{viewStatus:t}=e;return(0,a.useEffect)(()=>{window.InpkCommonTagManager.initialize({gtmId:"GTM-MPP5PKHJ"}),window.InpkCommonTagManager.scriptInject()},[]),(0,a.useLayoutEffect)(()=>{let e=document.getElementById("__next");return e&&(e.style.height="100%"),()=>{e&&(e.style.height="")}},[]),(0,s.jsx)(components,{viewStatus:t})}},7579:function(){},1784:function(){},5036:function(){},2361:function(){},4616:function(){}},function(e){e.O(0,[544,714,296,885,774,888,179],function(){return e(e.s=9758)}),_N_E=e.O()}]);